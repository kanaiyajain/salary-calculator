<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Invoice Generator – Redcoupons</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* --- PRINT & PDF STYLES (A4 Portrait) --- */
        @media print {
            @page {
                size: A4 portrait;
                margin: 10mm;
            }
            body {
                margin: 0;
                padding: 0;
            }
            .no-print {
                display: none !important;
            }
            .sign-box {
                page-break-inside: avoid;
            }
        }

        /* --- GENERAL STYLES --- */
        body {
            font-family: "Segoe UI", Tahoma, sans-serif;
            background: #f5f5f5;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 800px;
            margin: 20px auto;
            background: #fff;
            padding: 20px;
            box-shadow: 0 0 8px rgba(0,0,0,.15);
        }
        h2 {
            text-align: center;
            margin-top: 0;
        }
        label {
            display: block;
            margin: 6px 0 2px;
            font-weight: 600;
        }
        input, textarea, select {
            width: 100%;
            padding: 6px 8px;
            box-sizing: border-box;
            margin-bottom: 8px;
            border: 1px solid #bbb;
            border-radius: 4px;
        }
        .row {
            display: flex;
            gap: 12px;
        }
        .row > div {
            flex: 1;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            border: 1px solid #bbb;
            padding: 6px 8px;
            text-align: left;
        }
        th {
            background: #f2f2f2;
        }
        .right {
            text-align: right;
        }
        .center {
            text-align: center;
        }
        .sign-box {
            margin-top: 40px;
            display: flex;
            justify-content: flex-end;
        }
        .sign-box div {
            border-top: 1px solid #000;
            width: 200px;
            text-align: center;
            padding-top: 4px;
        }
        button {
            background: #0077cc;
            color: #fff;
            border: none;
            padding: 10px 18px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 15px;
        }
        button:hover {
            background: #005fa3;
        }
    </style>
</head>
<body>

<div class="container no-print">
    <h2>Freelance Invoice Generator</h2>

    <div class="row">
        <div>
            <label>Invoice Issuer Name</label>
            <input type="text" id="issuerName" placeholder="Your Name">
        </div>
        <div>
            <label>Invoice Issuer Address</label>
            <textarea id="issuerAddress" rows="2" placeholder="Your Address"></textarea>
        </div>
    </div>

    <div class="row">
        <div>
            <label>PAN Card</label>
            <input type="text" id="pan" placeholder="PAN (optional)">
        </div>
        <div>
            <label>Bank Name</label>
            <input type="text" id="bankName" placeholder="Bank Name">
        </div>
    </div>

    <div class="row">
        <div>
            <label>Account Number</label>
            <input type="text" id="accNo" placeholder="Account Number">
        </div>
        <div>
            <label>IFSC</label>
            <input type="text" id="ifsc" placeholder="IFSC">
        </div>
    </div>

    <div class="row">
        <div>
            <label>Invoice Date</label>
            <input type="date" id="invDate">
        </div>
        <div>
            <label>Invoice Number</label>
            <input type="text" id="invNo" placeholder="Leave blank for auto">
        </div>
    </div>

    <hr style="margin: 15px 0;">

    <h3>Invoice Particulars</h3>
    <table id="itemsTable">
        <thead>
            <tr>
                <th>Description</th>
                <th style="width:80px">Qty</th>
                <th style="width:120px">Price (₹)</th>
                <th style="width:140px">Amount (₹)</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><input type="text" class="desc" value="Online Content Writing for Month /2025"></td>
                <td><input type="number" class="qty" value="1" min="0"></td>
                <td><input type="number" class="price" value="0" min="0" step="0.01"></td>
                <td class="amount right">0.00</td>
            </tr>
        </tbody>
    </table>
    <button type="button" onclick="addRow()">+ Add Row</button>

    <hr style="margin: 15px 0;">

    <button onclick="generatePDF()">Generate Invoice PDF</button>
</div>

<!-- ====================  INVOICE (PDF) AREA  ==================== -->
<div id="invoiceArea" style="display:none;">
    <div style="padding:10px;">
        <table style="width:100%;border:none;">
            <tr>
                <td style="border:none;">
                    <strong>Invoice</strong><br>
                    Date: <span id="pdfDate"></span><br>
                    Invoice No: <span id="pdfInvNo"></span>
                </td>
                <td style="border:none;text-align:right;">
                    <strong>Redcoupons Private Limited</strong><br>
                    Ward No. 29, Pani Tanki Ke Pass, Nokha, Bikaner,<br>
                    Nokha, Rajasthan, India, 334803<br>
                    CIN: U73100RJ2024PTC098563
                </td>
            </tr>
        </table>

        <table style="width:100%;margin-top:15px;">
            <thead>
                <tr>
                    <th>Description</th>
                    <th style="width:80px">Qty</th>
                    <th style="width:120px">Price (₹)</th>
                    <th style="width:140px">Amount (₹)</th>
                </tr>
            </thead>
            <tbody id="pdfItems"></tbody>
            <tfoot>
                <tr>
                    <th colspan="3" class="right">Sub Total</th>
                    <th id="pdfSubTotal" class="right">0.00</th>
                </tr>
            </tfoot>
        </table>

        <div style="margin-top:15px;">
            <strong>Total Amount (in words): </strong><span id="pdfWords"></span>
        </div>

        <div style="margin-top:20px;">
            <strong>Payment Information:</strong><br>
            Bank: <span id="pdfBank"></span><br>
            A/C No: <span id="pdfAcc"></span><br>
            IFSC: <span id="pdfIfsc"><br>
            PAN: <span id="pdfPan"></span>
        </div>

        <div class="sign-box">
            <div>Signature of Issuer</div>
        </div>
    </div>
</div>

<!-- ====================  SCRIPTS  ==================== -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
    /* ---- Utilities ---- */
    function numToWords(n) {
        const a = ['','One ','Two ','Three ','Four ','Five ','Six ','Seven ','Eight ','Nine ','Ten ','Eleven ','Twelve ','Thirteen ','Fourteen ','Fifteen ','Sixteen ','Seventeen ','Eighteen ','Nineteen '];
        const b = ['', '', 'Twenty','Thirty','Forty','Fifty', 'Sixty','Seventy','Eighty','Ninety'];
        if ((n = n.toString()).length > 9) return 'overflow';
        n = ('000000000'+n).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);
        if (!n) return; var str = '';
        str += (n[1] != 0) ? (a[Number(n[1])] || b[n[1][0]] + ' ' + a[n[1][1]]) + 'Crore ' : '';
        str += (n[2] != 0) ? (a[Number(n[2])] || b[n[2][0]] + ' ' + a[n[2][1]]) + 'Lakh ' : '';
        str += (n[3] != 0) ? (a[Number(n[3])] || b[n[3][0]] + ' ' + a[n[3][1]]) + 'Thousand ' : '';
        str += (n[4] != 0) ? (a[Number(n[4])] || b[n[4][0]] + ' ' + a[n[4][1]]) + 'Hundred ' : '';
        str += (n[5] != 0) ? ((str != '') ? 'and ' : '') + (a[Number(n[5])] || b[n[5][0]] + ' ' + a[n[5][1]]) + 'only ' : 'only';
        return str.trim();
    }

    function currencyFormat(n) {
        return '₹' + Number(n).toLocaleString('en-IN', {minimumFractionDigits: 2, maximumFractionDigits: 2});
    }

    /* ---- Table Row Management ---- */
    function calcRow(row) {
        const qty = parseFloat(row.querySelector('.qty').value) || 0;
        const price = parseFloat(row.querySelector('.price').value) || 0;
        const amt = qty * price;
        row.querySelector('.amount').textContent = currencyFormat(amt);
        return amt;
    }

    function updateTotals() {
        let tot = 0;
        document.querySelectorAll('#itemsTable tbody tr').forEach(r => tot += calcRow(r));
        document.getElementById('pdfSubTotal').textContent = currencyFormat(tot);
        document.getElementById('pdfWords').textContent = numToWords(Math.round(tot)) + '';
    }

    function addRow() {
        const tbody = document.querySelector('#itemsTable tbody');
        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td><input type="text" class="desc" placeholder="Description"></td>
            <td><input type="number" class="qty" min="0" value="1"></td>
            <td><input type="number" class="price" min="0" step="0.01" value="0"></td>
            <td class="amount right">₹0.00</td>
        `;
        tbody.appendChild(tr);
        attachRowListeners(tr);
        updateTotals();
    }

    function attachRowListeners(row) {
        row.querySelectorAll('input').forEach(inp => inp.addEventListener('input', updateTotals));
    }

    /* ---- PDF Generation ---- */
    function generatePDF() {
        // Fill PDF area
        document.getElementById('pdfDate').textContent = document.getElementById('invDate').value || new Date().toISOString().split('T')[0];
        let invNo = document.getElementById('invNo').value.trim();
        if (!invNo) invNo = 'INV-' + Date.now().toString().slice(-6);
        document.getElementById('pdfInvNo').textContent = invNo;

        // Issuer info
        document.getElementById('pdfBank').textContent = document.getElementById('bankName').value;
        document.getElementById('pdfAcc').textContent = document.getElementById('accNo').value;
        document.getElementById('pdfIfsc').textContent = document.getElementById('ifsc').value;
        document.getElementById('pdfPan').textContent = document.getElementById('pan').value;

        // Items
        const pdfItems = document.getElementById('pdfItems');
        pdfItems.innerHTML = '';
        let sub = 0;
        document.querySelectorAll('#itemsTable tbody tr').forEach(r => {
            const desc = r.querySelector('.desc').value || 'Item';
            const qty = r.querySelector('.qty').value || 0;
            const price = r.querySelector('.price').value || 0;
            const amt = qty * price;
            sub += amt;
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${desc}</td>
                <td class="center">${qty}</td>
                <td class="right">${currencyFormat(price)}</td>
                <td class="right">${currencyFormat(amt)}</td>
            `;
            pdfItems.appendChild(tr);
        });
        document.getElementById('pdfSubTotal').textContent = currencyFormat(sub);
        document.getElementById('pdfWords').textContent = numToWords(Math.round(sub));

        // Create PDF
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF('p', 'mm', 'a4');
        doc.setProperties({ title: 'Invoice' });

        doc.html(document.getElementById('invoiceArea'), {
            callback: function (doc) {
                doc.save('Invoice.pdf');
            },
            x: 10,
            y: 10,
            width: 190, // A4 width minus margins
            windowWidth: 800
        });
    }

    /* ---- Initialization ---- */
    document.addEventListener('DOMContentLoaded', () => {
        document.getElementById('invDate').valueAsDate = new Date();
        document.querySelectorAll('#itemsTable tbody tr').forEach(attachRowListeners);
        updateTotals();
    });
</script>

</body>
</html>
