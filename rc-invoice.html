<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Invoice Generator</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<style>
  body { font-family: 'Arial', sans-serif; background: #f5f7fa; padding: 20px; color: #333; }
  h2 { text-align: center; }
  form { background: #fff; padding: 20px; border-radius: 10px; margin-bottom: 20px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
  label { display: block; margin-top: 10px; font-weight: bold; }
  input, textarea { width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; border-radius: 5px; }
  table { width: 100%; border-collapse: collapse; margin-top: 15px; }
  th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
  th { background: #0a2e6c; color: #fff; }
  #invoice { background: #fff; padding: 40px; margin: auto; border-radius: 10px; width: 210mm; min-height: 297mm; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
  .header { text-align: center; margin-bottom: 30px; }
  .footer { text-align: right; margin-top: 30px; font-weight: bold; }
  .sign { margin-top: 50px; text-align: right; }
  .thankyou { text-align: center; font-size: 20px; font-weight: bold; color: #0a2e6c; margin-top: 30px; }
</style>
</head>
<body>

<h2>Freelancer Invoice Generator</h2>
<form id="invoiceForm">
  <label>Invoice Issuer Name:</label>
  <input type="text" id="issuerName" required>

  <label>Address:</label>
  <textarea id="issuerAddress" required></textarea>

  <label>PAN Card:</label>
  <input type="text" id="pan" value="XXXXXXXXXX">

  <label>Bank Name:</label>
  <input type="text" id="bankName" required>

  <label>Account Number:</label>
  <input type="text" id="accountNumber" value="XXXXXXXXXXXX">

  <label>IFSC Code:</label>
  <input type="text" id="ifsc" value="XXXX0000000">

  <label>Invoice Date:</label>
  <input type="date" id="invoiceDate" required>

  <label>Invoice Number:</label>
  <input type="text" id="invoiceNumber" placeholder="Leave blank if not available">

  <h3>Service Details</h3>
  <table id="itemsTable">
    <tr>
      <th>Description</th>
      <th>Qty</th>
      <th>Price</th>
      <th>Amount</th>
    </tr>
    <tr>
      <td><input type="text" value="Online Content Writing for Month /2025" class="desc"></td>
      <td><input type="number" value="1" class="qty"></td>
      <td><input type="number" value="0" class="price"></td>
      <td><input type="number" value="0" class="amount" readonly></td>
    </tr>
  </table>
  <button type="button" onclick="addRow()">+ Add Row</button>
  <br><br>
  <button type="button" onclick="generateInvoice()">Generate Invoice PDF</button>
</form>

<div id="invoice" style="display:none;">
  <div class="header">
    <h1>INVOICE</h1>
    <p><strong>Invoice No:</strong> <span id="showInvoiceNumber"></span><br>
    <strong>Date:</strong> <span id="showInvoiceDate"></span></p>
  </div>

  <p><strong>Bill To:</strong><br>
  Redcoupons Private Limited<br>
  Ward No. 29, Pani Tanki Ke Pass,<br>
  Nokha, Bikaner, Nokha, Rajasthan, India, 334803<br>
  CIN: U73100RJ2024PTC098563</p>

  <p><strong>From:</strong><br>
  <span id="showIssuerName"></span><br>
  <span id="showIssuerAddress"></span><br>
  PAN: <span id="showPAN"></span></p>

  <table id="invoiceTable"></table>

  <p><strong>Total Amount:</strong> ₹<span id="totalAmount"></span></p>
  <p><strong>Amount in Words:</strong> <span id="amountWords"></span></p>

  <p><strong>Bank Details:</strong><br>
  Bank Name: <span id="showBankName"></span><br>
  A/C Number: <span id="showAccountNumber"></span><br>
  IFSC: <span id="showIFSC"></span></p>

  <div class="sign">
    <p>__________________________<br>Signature of Issuer</p>
  </div>

  <div class="thankyou">Thank You!</div>
</div>

<script>
function addRow() {
  const table = document.getElementById("itemsTable");
  const row = table.insertRow();
  row.innerHTML = `
    <td><input type="text" class="desc"></td>
    <td><input type="number" value="1" class="qty"></td>
    <td><input type="number" value="0" class="price"></td>
    <td><input type="number" value="0" class="amount" readonly></td>`;
}

function numberToWords(num) {
  const a = ['','One','Two','Three','Four','Five','Six','Seven','Eight','Nine','Ten','Eleven','Twelve','Thirteen','Fourteen','Fifteen','Sixteen','Seventeen','Eighteen','Nineteen'];
  const b = ['','', 'Twenty','Thirty','Forty','Fifty','Sixty','Seventy','Eighty','Ninety'];
  if ((num = num.toString()).length > 9) return 'Overflow';
  let n = ('000000000' + num).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/);
  if (!n) return; let str = '';
  str += (n[1] != 0) ? (a[Number(n[1])] || b[n[1][0]] + ' ' + a[n[1][1]]) + ' Crore ' : '';
  str += (n[2] != 0) ? (a[Number(n[2])] || b[n[2][0]] + ' ' + a[n[2][1]]) + ' Lakh ' : '';
  str += (n[3] != 0) ? (a[Number(n[3])] || b[n[3][0]] + ' ' + a[n[3][1]]) + ' Thousand ' : '';
  str += (n[4] != 0) ? (a[Number(n[4])] || b[n[4][0]] + ' ' + a[n[4][1]]) + ' Hundred ' : '';
  str += (n[5] != 0) ? ((str != '') ? 'and ' : '') + (a[Number(n[5])] || b[n[5][0]] + ' ' + a[n[5][1]]) + ' ' : '';
  return str + 'Rupees Only';
}

function generateInvoice() {
  const issuerName = document.getElementById("issuerName").value;
  const issuerAddress = document.getElementById("issuerAddress").value;
  const pan = document.getElementById("pan").value;
  const bankName = document.getElementById("bankName").value;
  const accountNumber = document.getElementById("accountNumber").value;
  const ifsc = document.getElementById("ifsc").value;
  const invoiceDate = document.getElementById("invoiceDate").value;
  const invoiceNumber = document.getElementById("invoiceNumber").value;

  let total = 0;
  let invoiceTable = `<tr><th>Description</th><th>Qty</th><th>Price</th><th>Amount</th></tr>`;
  document.querySelectorAll("#itemsTable tr").forEach((row, index) => {
    if (index === 0) return;
    const desc = row.querySelector(".desc").value;
    const qty = parseFloat(row.querySelector(".qty").value);
    const price = parseFloat(row.querySelector(".price").value);
    const amount = qty * price;
    row.querySelector(".amount").value = amount.toFixed(2);
    total += amount;
    invoiceTable += `<tr><td>${desc}</td><td>${qty}</td><td>₹${price.toFixed(2)}</td><td>₹${amount.toFixed(2)}</td></tr>`;
  });

  document.getElementById("showIssuerName").innerText = issuerName;
  document.getElementById("showIssuerAddress").innerText = issuerAddress;
  document.getElementById("showPAN").innerText = pan;
  document.getElementById("showBankName").innerText = bankName;
  document.getElementById("showAccountNumber").innerText = accountNumber;
  document.getElementById("showIFSC").innerText = ifsc;
  document.getElementById("showInvoiceDate").innerText = invoiceDate;
  document.getElementById("showInvoiceNumber").innerText = invoiceNumber;
  document.getElementById("invoiceTable").innerHTML = invoiceTable;
  document.getElementById("totalAmount").innerText = total.toFixed(2);
  document.getElementById("amountWords").innerText = numberToWords(Math.round(total));

  const invoice = document.getElementById("invoice");
  invoice.style.display = "block";

  const opt = {
    margin: 10,
    filename: `Invoice-${invoiceNumber || 'Redcoupons'}.pdf`,
    image: { type: 'jpeg', quality: 0.98 },
    html2canvas: { scale: 2 },
    jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
  };

  html2pdf().from(invoice).set(opt).save().then(() => {
    invoice.style.display = "none";
  });
}
</script>

</body>
</html>
